# **Virtualization-Based Security in Windows**

**Abstract:** Virtualization-based Security (VBS) in Windows represents a fundamental shift in operating system security, moving beyond traditional privilege separation to leverage hardware virtualization for isolating critical system components and sensitive data. This report provides a comprehensive technical analysis of VBS, detailing its architectural foundations, historical development, and the motivations behind its implementation. It further explores the evolving landscape of vulnerabilities and advanced exploitation techniques targeting VBS, drawing extensively from insights presented at major cybersecurity conferences such as Black Hat, Blue Hat, and Def Con, as well as advisories from the Microsoft Security Response Center (MSRC). The aim is to equip computer engineers with a deep understanding of VBS's capabilities, limitations, and the ongoing challenges in securing modern Windows environments.

## **1\. Introduction to Virtualization-Based Security (VBS)**

Virtualization-based Security (VBS) is a significant advancement in the Windows security architecture, designed to address the limitations of traditional operating system (OS) isolation mechanisms. Historically, Windows relied on processor ring levels (Ring0 for the kernel, Ring3 for user applications) to enforce separation. However, the increasing sophistication of kernel-level attacks and credential theft techniques demonstrated that this traditional model left the kernel as a single point of failure, where its compromise could undermine the entire system's security.[1] VBS introduces an additional security boundary, fundamentally altering the system's trust model.

### **1.1. Motivation: Enhancing Windows Security Posture**

The primary motivation behind VBS is to enhance the resilience of Windows against advanced threats by creating a more robust and isolated environment for critical security functions. The traditional security model, where the kernel was implicitly trusted, proved inadequate against persistent and sophisticated attacks that could gain kernel privileges. The introduction of VBS signifies a profound architectural re-evaluation, where the system's defensive strategy proactively anticipates and prepares for kernel-level breaches rather than solely focusing on their prevention.[3] This understanding is crucial for computer engineers designing and implementing secure systems in contemporary threat environments.

VBS specifically targets several high-impact threats:

* **Credential Theft:** A major objective of VBS is to protect sensitive authentication material, such such as NTLM password hashes and Kerberos Ticket Granting Tickets. Traditional methods of storing these in the Local Security Authority Subsystem Service (LSASS) memory made them vulnerable to extraction tools like Mimikatz.[6] VBS isolates these secrets in a protected environment, preventing their theft even if the main OS kernel is compromised.[2]  
* **Kernel Exploits and Rootkits:** VBS aims to ensure the integrity of critical OS components and prevent unauthorized or malicious code from executing in kernel mode. This directly mitigates the impact of kernel exploits and rootkit infections by enforcing strict code integrity policies.[2]  
* **Advanced Persistent Threats (APTs):** By creating isolated environments for security-critical operations, VBS helps to block advanced credential theft and code injection techniques frequently employed by APTs. This protection remains effective even when malware manages to gain administrative privileges within the primary operating system.[9]

The underlying philosophy of VBS is rooted in the assumption that the primary operating system kernel *can* be compromised. To counter this, VBS leverages hardware virtualization to establish a separate, isolated virtual environment. This secure environment serves as a new "root of trust," hosting critical security solutions and providing them with significantly increased protection from vulnerabilities in the main OS.[3] This architectural shift provides a more resilient and robust security posture for Windows systems.

### **1.2. Core Principles of VBS: Hardware-Assisted Isolation and Root of Trust**

VBS is intrinsically tied to the underlying hardware capabilities, relying on a combination of processor features and a specialized hypervisor to achieve its isolation goals.

* **Hardware Virtualization:** VBS is built upon hardware-assisted virtualization technologies, specifically Intel VT-x or AMD-V, which provide the necessary CPU extensions for virtualization. A crucial component is Second Level Address Translation (SLAT), implemented as Intel Extended Page Tables (EPT) or AMD Rapid Virtualization Indexing (RVI). SLAT is essential for efficiently managing memory isolation between different trust levels.[2]  
* **Hypervisor Role:** The Windows hypervisor forms the lowest layer of the VBS architecture. This component is a thin, low-level software layer responsible for creating and strictly separating the Virtual Trust Levels (VTL0 and VTL1). The hypervisor operates at a privilege level below the main operating system, ensuring its foundational control over the isolated environments.[2]  
* **Root of Trust Establishment:** By leveraging the hypervisor, VBS establishes an isolated virtual space that becomes the new "root of trust" for the system. This secure environment protects critical security functions and sensitive data, ensuring their integrity and confidentiality even if the standard operating system (VTL0) is compromised.[3]

While VBS offers substantial security benefits through hardware virtualization and memory isolation, these mechanisms inherently introduce computational overhead. Older CPUs may experience some performance degradation 11, and VBS generally introduces additional memory and CPU overhead, which can slightly degrade performance, especially on systems with lower-end hardware or high resource demands.[10] Furthermore, it can lead to an increased boot time as the system initializes its secure enclaves and loads additional security modules.[10] This highlights a critical design and deployment consideration for computer engineers: the trade-off between enhanced security and system performance. While VBS is indispensable for high-security environments, such as defense, energy, or government agencies 10, its performance impact might be a significant factor for performance-critical applications, such as gaming 15, or on systems with limited hardware resources. This necessitates careful hardware selection and optimization, aligning with recommendations for specific CPU generations (e.g., Intel Skylake-EP or AMD Zen 2 for best performance).[11]

## **2\. VBS Architecture and Core Components**

The architecture of VBS is layered, with the hypervisor at its base, creating distinct Virtual Trust Levels (VTLs) to enforce strict isolation. This foundation enables the operation of critical security features like Isolated User Mode (IUM) and VBS enclaves.

### **2.1. The Hyper-V Hypervisor: Foundation of VBS Isolation**

The Hyper-V hypervisor is the foundational layer underpinning VBS. Its primary role is to create and manage the isolated virtual environments, rigorously enforcing separation and memory protections between different Virtual Trust Levels (VTLs).[2] Operating at a privilege level below the main OS, the hypervisor acts as a critical security boundary. It utilizes Second Level Address Translation (SLAT) to configure memory protections, ensuring that the secure environment (VTL1) is isolated from the rest of the system, including the normal kernel (VTL0).[5]

It is important to differentiate the "Windows hypervisor" that VBS depends on from the full Hyper-V feature set typically used for creating and managing traditional virtual machines. While the latter is often unavailable in Windows Home editions, the underlying hypervisor component necessary for VBS mitigations like Memory Integrity is present and functional.[3]

The hypervisor is consistently described as the core of VBS's isolation and the "root of trust".[3] Early discussions at conferences like Black Hat in 2007 highlighted its minimal attack surface due to its thin microkernel design and lack of device drivers.[14] However, later research, such as the Black Hat 2016 paper, extensively detailed potential attack surfaces, including privileged hypercalls, physical memory access, and IO port access that a compromised root partition could leverage.[6] It also notes that while VBS prevents some well-known hypervisor attacks (e.g., HvCallDisableHypervisor, hibernation file tampering), the hypervisor itself remains the ultimate target for attackers seeking to completely undermine VBS.[6] This means that while VBS shifts the trust boundary, the hypervisor becomes the most critical component requiring robust protection. Vulnerabilities within the hypervisor's implementation, or mechanisms that bypass its controls (such as System Management Mode (SMM) attacks or certain Secure Boot flaws), represent the most severe compromise of the VBS security model. This underscores the continuous need for deep research into hypervisor hardening and the absolute importance of hardware-rooted trust (TPM, Secure Boot) to protect the hypervisor's integrity from the earliest boot stages.

### **2.2. Virtual Trust Levels (VTLs): VTL0 (Normal World) and VTL1 (Secure World)**

Virtual Secure Mode (VSM), a key component of VBS, divides the system into two distinct levels of trust:

* **VTL0 (Normal World):** This corresponds to the traditional operating system environment, where the standard NTOS kernel runs in Ring0 and regular user-mode applications execute in Ring3.1  
* **VTL1 (Secure World):** This is the more secure, isolated virtual environment. Code executing in VTL1 possesses higher privileges and is fully protected from processes running in VTL0, even if the VTL0 environment is compromised.[1]

The introduction of VTLs results in four primary execution modes: Ring0 VTL0 (Normal kernel mode), Ring0 VTL1 (Secure kernel mode), Ring3 VTL0 (Normal user mode), and Ring3 VTL1 (Isolated user mode, IUM).[1] The Hyper-V hypervisor is responsible for enforcing this VTL isolation by dynamically assigning exclusive memory blocks to VTL0 and VTL1 at boot time and throughout system operation, leveraging SLAT to apply appropriate access permissions and prevent cross-VTL memory access.[1]

### **2.3. Isolated User Mode (IUM) and Trustlets**

Isolated User Mode (IUM) is a critical component of VSM, providing a high-privilege execution environment within VTL1. It is designed to run user-mode code in a secure memory space that is inaccessible to lower-privileged processes, including the operating system kernel and endpoint detection tools operating in VTL0.1 Programs running as IUM processes are formally known as "trustlets" (or trusted processes, secure processes). These trustlets handle sensitive system calls by marshalling them over to the Windows kernel running in VTL0, ensuring that sensitive operations remain protected.[7]

A key example of a trustlet in action is the Local Security Authority (LSASS) environment when VSM is enabled. Credential Guard (CG), a flagship VBS feature, extensively utilizes IUM. Its primary function is to protect sensitive credentials, such as NTLM password hashes and Kerberos Ticket Granting Tickets, by isolating them within the VTL1 environment, making them inaccessible to malware.[1] The LSAISO.exe trustlet runs in VTL1 and communicates with LSASS.exe (which runs in VTL0) via a secure RPC channel. Secrets managed by LSAISO are encrypted before being transmitted to LSASS in VTL0, ensuring that unencrypted authentication material is never stored in the LSASS memory accessible to VTL0.6 This design directly mitigates "pass-the-hash" attacks by preventing attackers from scraping plaintext or hashed credentials directly from the LSASS process in the compromised VTL0 environment.[6]

A critical security implication of IUM is the inability to attach debuggers to, or inject code (e.g., DLLs, threads, Asynchronous Procedure Calls (APCs)) into, an IUM process from VTL0. Attempts to do so may destabilize the entire system or fail in unexpected ways, reinforcing the isolation boundary. Standard Windows APIs like CreateRemoteThread, VirtualAllocEx, and Read/WriteProcessMemory will not function as expected against trustlets.[7]

While IUM and VBS enclaves are engineered to provide robust protection by isolating sensitive data from VTL0 compromise, this very isolation creates a significant challenge for defenders. Research by Akamai 1 and discussions at Blue Hat IL 21 explicitly highlight that these isolated environments are "appealing to attackers".[1] Malware running within an enclave can be "potentially invisible to memory-based detection and forensics" 1 and can "bypass traditional detection mechanisms".[18] This effectively creates a blind spot for conventional Endpoint Detection and Response (EDR) systems and security analysts. For computer engineers involved in developing security solutions or conducting incident response, this means that traditional tools and techniques (e.g., memory scanners, API hooks, kernel-level monitoring) may be ineffective against malware residing within VBS enclaves. New detection strategies are imperative, such as establishing baselines for legitimate enclave usage, monitoring for anomalous activity, and tracking enclave-specific API calls (like CreateEnclave) or the loading of enclave-related libraries (e.g., Vertdll.dll).[18] This illustrates the continuous arms race in cybersecurity, where defensive innovations can be repurposed for offensive advantage, demanding constant adaptation from the security community.

### **2.4. VBS Enclaves: Software-Based Trusted Execution Environments**

VBS enclaves are a type of software-based Trusted Execution Environment (TEE) that operate within the address space of a host application. They reside in Isolated User Mode (IUM) within VTL1, meaning the data and code inside an enclave are strictly inaccessible to anything running in VTL0, including the normal kernel.[1]

The purpose of VBS enclaves is to isolate sensitive operations, protect intellectual property, or secure critical data from potential compromise of the main operating system. Practical applications include Enhanced Phishing Protection in Microsoft Defender SmartScreen and the Always Encrypted feature in SQL Server 2019+.[1]

The interaction within VBS enclaves involves two main components:

* **Enclave Host Application (VTL0):** This is a standard user-mode application that initiates the enclave. It creates and initializes the enclave, allocates a virtual address range, and loads the enclave module.[16]  
* **Enclave DLL (VTL1):** This is a Dynamic Link Library (DLL) specifically compiled for enclave execution. Once loaded into the enclave, it becomes the trusted execution environment. The host application can only interact with the enclave by invoking functions exported by its modules using the CallEnclave API.[1]

For the Secure Kernel to consider an enclave module trustworthy and load it into VTL1, the DLL must be production-signed, typically using Microsoft's Azure Trusted Signing platform.[1] Microsoft made VBS Enclave development available to third-party application developers in May 2024, although the underlying VBS functionality supporting enclaves has been present since the initial versions of Windows 10\.[16]

VBS enclaves are fundamentally designed as "trusted execution environments" 1, implying a high degree of security. However, the decision to allow third-party developers to create and sign these enclaves introduces a critical new attack surface.[16] The "Bring Your Own Vulnerable Enclave" (BYOVE) technique, highlighted by Akamai researchers 18, directly exploits vulnerabilities found within *legitimately signed* enclave modules (e.g., CVE-2023-36880 in Microsoft Edge).[1] This mirrors the well-known "Bring Your Own Vulnerable Driver" (BYOVD) attacks, where signed but flawed drivers are misused. This means that the trust placed in the *signing* of an enclave module is paramount, and not just the inherent architectural security of VBS itself. A signed, yet vulnerable, enclave from a reputable vendor can become a powerful vector for attackers to gain a stealthy and privileged foothold within VTL1. This underscores the critical need for rigorous security auditing of all third-party enclave modules, a robust patch management strategy for these components, and continuous vigilance regarding the integrity of Microsoft's Trusted Signing platform.

### **2.5. Key VBS Features: Credential Guard and Hypervisor-Protected Code Integrity (HVCI)**

Beyond the foundational VTLs and IUM, VBS enables several critical security features that directly benefit Windows systems:

* **Credential Guard (CG):** As discussed, Credential Guard is a core VBS feature that protects sensitive secrets (such as NTLM hashes and Kerberos Ticket Granting Tickets) by isolating them within a VBS-protected environment. This isolation is specifically designed to prevent credential theft attacks, even if the primary operating system is compromised.[2]  
* **Hypervisor-Protected Code Integrity (HVCI) / Memory Integrity:** HVCI is a fundamental VBS feature that enforces strict memory integrity. It ensures that only trusted and cryptographically signed code is permitted to run in kernel mode, thereby preventing the execution of unauthorized or malicious code.[1] This mechanism actively prevents unsigned or untrusted drivers and system files from being loaded into system memory, serving as a critical defense against rootkits and kernel-level malware.[3] HVCI also imposes restrictions on kernel memory allocations and, crucially, ensures that kernel memory pages are only made executable after passing rigorous code integrity checks within the secure runtime environment. Furthermore, executable pages themselves are never writable, effectively mitigating buffer overflows and other memory corruption exploits.[3] In user-facing settings, HVCI is often referred to as "Memory Integrity" within the Windows Security application.[3]

### **2.6. Hardware and Firmware Requirements for VBS Implementation**

The effectiveness of VBS is deeply contingent upon the underlying hardware's security capabilities. Simply enabling VBS in software is insufficient for comprehensive protection; a truly secure VBS deployment demands a holistic approach, ensuring that the entire hardware and firmware stack meets and maintains the specified security standards. This also implies that vulnerabilities residing in firmware (e.g., SMM bugs) or hardware (e.g., speculative execution side-channels like L1TF/MDS) can fundamentally undermine the VBS security model, even if VBS itself is correctly configured.[6] This necessitates a "trust-from-the-ground-up" approach to system design and auditing.

The following components are essential for enabling and effectively utilizing Virtualization-based Security in Windows environments:

**Table 2.1: Essential Hardware and Firmware Requirements for VBS**

| Category | Requirement | Details |
| :---- | :---- | :---- |
| **Hardware** | **64-bit CPU** | Mandatory for VBS, supporting Windows hypervisor. |
|  | **Virtualization Extensions** | Intel VT-x or AMD-V required. |
|  | **Second Level Address Translation (SLAT)** | Intel EPT or AMD RVI required for efficient memory isolation. |
|  | **IOMMU (Input/Output Memory Management Unit)** | Intel VT-d, AMD-Vi, or Arm64 SMMUs required for Device Guard, highly recommended for Credential Guard. Protects against Direct Memory Access (DMA) attacks. |
|  | **Trusted Platform Module (TPM) 2.0** | Recommended for optimal security, crucial for protecting cryptographic keys and binding them to platform's trusted boot state. |
| **Firmware** | **UEFI Firmware (v2.3.1.c or higher)** | Required with Secure Boot enabled. |
|  | **Secure Boot** | Ensures only trusted bootloaders and OS components load. |
|  | **Windows SMM Security Mitigations Table (WMST) Compliance** | Firmware must adhere to WMST specifications to harden against System Management Mode (SMM) attacks. |
|  | **UEFI Memory Attributes Table (MAT) Reporting** | Ensures proper segregation and reporting of EFI runtime memory ranges, with executable memory being read-only and writable memory non-executable. |
|  | **Secure Memory Overwrite Request (MOR) revision 2** | Enhanced protection for MOR lock setting using a UEFI secure variable. |
|  | **HVCI-compatible drivers** | All system drivers must be tested and verified for compatibility with memory integrity. |
| **Software** | **Windows Edition** | Primarily supported on Windows 10/11 Enterprise, Education, and Pro editions, and Windows Server 2016, 2019, 2025+. |

The extensive list of hardware and firmware requirements 5 clearly indicates that VBS is not merely a software feature; its effectiveness is deeply contingent upon the underlying hardware's security capabilities. The explicit mention of TPM, IOMMUs, Secure Boot, and SMM hardening highlights that the integrity of these physical components directly impacts VBS's security guarantees. The Black Hat 2016 paper critically points out that while Microsoft documentation might list VT-d and TPM as "optional," they are, in fact, *necessary* to protect the hypervisor against a compromised root partition.[6] This reveals a potential discrepancy in official messaging versus practical security reality. For computer engineers, this means that simply enabling VBS in software is insufficient for comprehensive protection. A truly secure VBS deployment demands a holistic approach, ensuring that the entire hardware and firmware stack meets and maintains the specified security standards. This also implies that vulnerabilities residing in firmware (e.g., SMM bugs) or hardware (e.g., speculative execution side-channels like L1TF/MDS) can fundamentally undermine the VBS security model, even if VBS itself is correctly configured. This necessitates a "trust-from-the-ground-up" approach to system design and auditing.

## **3\. Historical Development and Evolution of VBS**

The journey of VBS in Windows reflects a continuous effort by Microsoft to enhance system security in response to an evolving threat landscape, marked by significant architectural shifts and strategic deployment decisions.

### **3.1. Genesis: VBS Introduction in Windows 10**

Virtualization-based Security was first introduced as a key security feature with the release of Windows 10 and Windows Server 2016\.[10] This marked a deliberate shift towards a more hardware-backed security model for the Windows ecosystem. From its inception, VBS provided the underlying platform for critical security features such as Credential Guard and Hypervisor-Protected Code Integrity (HVCI), designed to protect sensitive credentials and ensure kernel integrity.[1]

Early adoption of VBS was heavily reliant on the availability of compatible modern hardware. This included specific Intel (Haswell/Ivy Bridge/Sandy Bridge) and AMD (Zen 2\) CPUs, along with UEFI firmware, Secure Boot, VT-x/AMD-V, SLAT, and TPM.[8] Due to these stringent requirements and potential performance impacts on older systems, VBS was often not enabled by default in its early stages.[10] Despite its introduction in Windows 10, VBS did not achieve immediate widespread default enablement. The understanding was that it would take "years before VBS is enabled everywhere" and that "each new feature update for Windows 10 should provide wider support for VBS so that it can be enabled out-of-the-box by OEMs".[20] The specific mention of the Samsung Galaxy Book2 in late 2019 as the first device with VBS enabled by default 20 illustrates this gradual integration, indicating a reliance on hardware maturation and OEM partnerships. For computer engineers, this historical context explains why older Windows 10 systems might not have VBS enabled by default and why consulting hardware compatibility lists remains crucial for VBS deployment. It suggests that Microsoft's approach to rolling out foundational security features is often a slow, iterative process, balancing security advancements with hardware readiness, performance optimization, and ecosystem adoption.

### **3.2. Feature Enhancements and Default Enablement (Windows 11, Windows Server 2025\)**

VBS has continued to be a cornerstone security feature in Windows 11, building upon its foundation from Windows 10\.[10] A significant evolution occurred with Windows 11, version 22H2, and Windows Server 2025, where VBS and Credential Guard began to be enabled by default on devices meeting the necessary hardware requirements.[9] This default enablement is configured "without UEFI Lock," which allows administrators the flexibility to remotely disable Credential Guard if needed.[26]

VBS enclaves, a novel software-based Trusted Execution Environment (TEE), were introduced in July 2024\. This feature allowed third-party developers to protect sensitive portions of their application data within the VBS isolated environment.[1] The default enablement of VBS and Credential Guard "without UEFI Lock" is a nuanced decision. While a UEFI lock provides a stronger security guarantee by physically preventing remote disabling 26, opting for "without UEFI lock" by default prioritizes manageability and flexibility, particularly for large enterprise deployments where remote configuration and troubleshooting are essential. This indicates a pragmatic approach by Microsoft, balancing stringent security with operational realities and ease of deployment. For computer engineers, this design choice underscores the trade-offs inherent in enterprise security. While a "locked down" system might offer maximum theoretical protection, it can hinder IT operations. Understanding this balance is crucial for selecting the appropriate VBS configuration based on an organization's specific risk appetite, operational requirements, and existing management infrastructure. It also highlights the need for robust remote management capabilities that can securely toggle such features.

### **3.3. Recent Shifts: VBS Enclave Deprecation in Older Windows Versions**

In a surprising development, Microsoft announced in April 2025 the phasing out of VBS enclaves for Windows 11 23H2 and earlier versions, as well as Windows Server 2022 and earlier releases.[22] Despite this deprecation, VBS enclave support is explicitly stated to continue in Windows Server 2025 and later, and for Windows 11 Build 26100.2314 or newer (which corresponds to Windows 11 24H2).[22] The rapid development cycle of Windows 11, characterized by annual major updates and frequent monthly updates, is cited as a probable reason for this decision.[27] Microsoft may be deliberately excluding older builds to streamline development, avoid compatibility issues, and ensure reliability with new security features.

The rapid deprecation of VBS enclaves for older Windows 11 versions, mere months after their introduction in July 2024 22, is a notable event for a feature initially touted as "revolutionary." Microsoft's explanation points to the accelerated Windows 11 development cycle.[27] This suggests that maintaining compatibility and ensuring stability for complex, cutting-edge security features across numerous, rapidly evolving OS versions becomes an unsustainable burden for the developer. For computer engineers, this highlights the inherent challenges of deploying and managing security features within a fast-paced "software-as-a-service" operating system model. It means that even critical features might have shorter lifecycles than traditionally expected, necessitating that organizations stay current with OS versions to maintain access to the latest security capabilities. This also implies a strategic decision by Microsoft to focus development efforts and support on newer, more controlled builds, potentially leading to a divergence in security feature sets across different Windows versions and editions.

## **4\. Vulnerabilities and Exploitation Techniques**

While VBS significantly enhances Windows security, it is not impervious to attack. The introduction of new security boundaries often creates new targets for sophisticated adversaries.

### **4.1. Misuse of VBS Enclaves for Evasive Malware**

Despite being designed for isolation and security, VBS enclaves can be actively misused by attackers. By operating within VTL1, malware residing in enclaves becomes inaccessible to traditional VTL0-based detection mechanisms, including most Endpoint Detection and Response (EDR) systems and memory scanners, making it highly evasive.[1]

Several techniques have been identified for exploiting VBS enclaves:

* **Exploiting Operating System Vulnerabilities:** Attackers can leverage flaws in the operating system itself to subvert enclave security. For instance, CVE-2024-49706 was a vulnerability that allowed unsigned modules to be loaded into enclaves, a critical flaw that has since been patched by Microsoft.[18]  
* **Abusing Debuggable Enclave Modules:** Certain enclave modules may be configured as "debuggable," which inadvertently grants memory access and code execution capabilities within the enclave. Attackers can exploit this by overwriting legitimate functions within such modules with their own malicious shellcode and executing it stealthily, bypassing typical monitoring.[1]  
* **"Bring Your Own Vulnerable Enclave" (BYOVE) Attacks:** This particularly concerning technique is analogous to the well-known "Bring Your Own Vulnerable Driver" (BYOVD) tactic. In BYOVE, attackers exploit vulnerabilities in *signed* enclave modules from legitimate vendors (e.g., CVE-2023-36880 found in Microsoft Edge). By leveraging these flaws, attackers can gain arbitrary read/write access or execute malicious payloads directly within the secure enclave, leveraging its trusted status.[1]  
* **Advanced Evasion: The "Mirage" Technique:** Developed by security researchers, "Mirage" is an advanced memory evasion technique that utilizes VBS enclaves to store malicious payloads in VTL1 memory. This makes the payloads inaccessible to traditional memory scanners operating in VTL0. The technique involves periodically transferring the payloads back to regular memory for execution, after which they are immediately erased, leaving minimal traceable evidence in system memory.[1]

The rapid emergence and detailed documentation of techniques for abusing VBS enclaves (exploiting OS vulnerabilities, misusing debuggable modules, BYOVE, and the "Mirage" technique) 1 vividly illustrate a continuous adversarial innovation cycle. Microsoft introduces a sophisticated security feature (VBS enclaves, July 2024 27), and almost immediately, security researchers (Akamai, Outflank 1) and malicious actors find creative ways to subvert its intended purpose. The "Mirage" technique, in particular, demonstrates how attackers adapt to new security boundaries by leveraging the very isolation designed to protect. For computer engineers, this signifies that no security feature, no matter how advanced, is a panacea. The introduction of VBS creates a new "high-value" target for attackers, and the security community must continuously research and develop countermeasures. This situation creates a "blind spot" for traditional EDRs. It emphasizes the critical need for proactive threat intelligence, rapid patching of discovered vulnerabilities (like CVE-2024-49706 and CVE-2023-36880), and the development of new detection strategies that can peer into or infer activity within VTL1.

### **4.2. Credential Guard: Attack Surface and Limitations**

Credential Guard's main objective is to prevent credential theft, particularly "pass-the-hash" attacks, by isolating sensitive secrets (NTLM password hashes and Kerberos Ticket Granting Tickets) within the highly protected VTL1 environment.[6] However, even with Credential Guard enabled, certain attack vectors and limitations exist:

* **SSO Exploitation (Pre-Reboot Persistence):** While Credential Guard ensures that lsass.exe in VTL0 no longer stores unencrypted hashes, an attacker who has compromised the VTL0 environment with user privileges can still leverage Single Sign-On (SSO) to authenticate to other network resources.[6] More critically, if an attacker gains SYSTEM privileges and collects the encrypted credential blob from LSASS memory, they can call LsaIso functions to authenticate as the user *until the system reboots*.[6] This means lateral movement is possible, albeit limited to the compromised machine and temporary.  
* **Plaintext Capture at Logon:** Unencrypted credentials are still processed and delivered to VTL1 during the initial logon process. An attacker with kernel-level access in VTL0 could potentially capture plaintext credentials via sophisticated keyloggers or memory interception if the user logs on again while the machine is compromised, unless smart-card based authentication (which offers stronger protection) is used.[6]

The persistent challenge of credential protection means that Credential Guard, while a significant improvement, is not a complete solution against all forms of credential compromise. Its effectiveness is maximized when combined with other robust security practices, such as strong multi-factor authentication, timely patching, and careful monitoring of privileged accounts. The fact that an attacker with SYSTEM privileges can still leverage encrypted credential blobs pre-reboot underscores the importance of rapid incident response and system remediation following a compromise.

### **4.3. Hypervisor-Protected Code Integrity (HVCI): Bypass Mechanisms**

HVCI's primary goal is to enforce kernel code integrity and prevent the execution of unsigned code in kernel mode.[1] Despite its robust design, researchers have identified methods to bypass or undermine HVCI:

* **RWX Pages in EPT:** A vulnerability (MS16-066) was discovered where Read-Write-Execute (RWX) pages existed in EPT dumps of a Windows 10 system with KMCI enabled, which should not occur for signed code. These pages, possibly storing early boot or UEFI-related code, were returned to the kernel with incorrect EPT permissions, allowing an attacker capable of corrupting kernel memory to execute arbitrary, unsigned code in kernel context. This vulnerability was reported to Microsoft and subsequently fixed.[6]  
* **Windows Downgrade Attacks:** Presented at Black Hat 2024, these attacks demonstrate how a local threat actor can replace current Windows system files with outdated, vulnerable versions. This can reintroduce previously mitigated vulnerabilities, bypass certain VBS features (including HVCI), and exfiltrate data protected by VBS.[33] This technique exploits incorrect assumptions about file immutability, leveraging Time-of-Check to Time-of-Use (TOCTOU) race conditions during file verification.[34]  
* **UEFI Lock Bypass:** Researchers have demonstrated methods to disable VBS even when enforced with UEFI locks, a mechanism designed to prevent remote disabling. This can involve invalidating VBS core files like SecureKernel.exe or exploiting specific race conditions during boot. While the "Mandatory" flag aims to prevent boot if VBS files are corrupted, it remains a target for sophisticated attackers seeking to completely disable VBS.[34]

The resilient nature of kernel exploitation means that attackers continuously seek the weakest link in the security chain. Bypasses for HVCI often target the underlying platform components, such as firmware, boot processes, or update mechanisms, rather than directly attacking the VTL1-enforced integrity checks. This highlights the importance of a comprehensive security strategy that extends beyond the OS kernel to include the entire platform's integrity, from hardware to firmware and update delivery.

### **4.4. Hardware-Level Vulnerabilities Impacting VBS**

The security guarantees of VBS are fundamentally dependent on the integrity of the underlying hardware. Vulnerabilities at the hardware or firmware level can directly undermine VBS's protective capabilities:

* **Speculative Execution Side-Channel Attacks (e.g., L1 Terminal Fault (L1TF), Microarchitectural Data Sampling (MDS)):** These vulnerabilities (e.g., CVE-2018-11091, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130) can compromise the confidentiality of Hyper-V virtual machines and VBS secrets, especially if Hyper-Threading (HT) is enabled. While VBS still provides benefits with HT enabled, the security boundary is weakened, allowing an attacker on one virtual machine to potentially access information from another VM or the host.[25]  
* **System Management Mode (SMM) Vulnerabilities:** Compromised SMM code can directly compromise the hypervisor, as SMM operates at a higher privilege level than the hypervisor. This can lead to the extraction of Credential Guard secrets or full control over hypervisor behavior.[6] The quality of SMM code is often perceived as poor, and more vulnerabilities are anticipated.[6]  
* **Secure Boot Vulnerabilities:** While Secure Boot is a requirement for VBS, numerous vulnerabilities in its implementation can be exploited from within the root partition. If not combined with TPM measurements, these flaws can allow a trojaned hypervisor to be loaded, bypassing VBS's code integrity protections.[6]  
* **DMA Attacks:** If an Input/Output Memory Management Unit (IOMMU) such as Intel VT-d or AMD-Vi is not enabled, malicious devices with Direct Memory Access (DMA) capabilities can directly access and compromise system memory, including hypervisor memory, thereby bypassing VBS protections.[5]

The interconnectedness of hardware and software security is paramount for VBS. VBS is only as strong as its weakest hardware link. This means that even if the VBS software components are perfectly implemented, vulnerabilities in the CPU, chipset, or firmware can fundamentally undermine its security guarantees. This necessitates a comprehensive security posture that includes rigorous hardware and firmware supply chain security, continuous auditing of low-level platform components, and the application of all available hardware mitigations.

## **5\. Learnings from Major Conferences and MSRCs**

Insights from leading cybersecurity conferences and the Microsoft Security Response Center (MSRC) provide a critical understanding of VBS's real-world security landscape, highlighting both its strengths and the persistent efforts to circumvent its protections.

### **5.1. Black Hat Learnings**

Black Hat conferences frequently serve as a bellwether for advanced exploitation techniques, often revealing cutting-edge offensive methods that force defensive evolution.

* **Early Hypervisor Security (Black Hat 2007):** Early discussions on Windows Server Virtualization and the Windows Hypervisor focused on its design as a thin, low-level microkernel aimed at eliminating ring compression and adding defense-in-depth. The security goals emphasized strong isolation between partitions, protection of guest data confidentiality and integrity, and non-interference between guests. Future benefits included powerful tools for virus isolation and improved forensic capabilities.[14]  
* **Windows 10 VBS Attack Surface (Black Hat 2016):** A detailed analysis of the attack surface of Windows 10 VBS highlighted its implementation details and potential issues. This research critically examined Credential Guard and Kernel Mode Code Integrity (KMCI) limitations, and extensively discussed hypervisor vulnerabilities related to System Management Mode (SMM), Secure Boot, and DMA attacks. It concluded that while VBS improved security, full protection required hardware features often deemed "optional".[6]  
* **Windows Downgrade Attacks (Black Hat 2024):** Recent presentations demonstrated sophisticated Windows Downgrade Attacks. These attacks enable local threat actors to replace current Windows system files with outdated versions, reintroducing previously mitigated vulnerabilities, bypassing certain VBS features (including HVCI), and exfiltrating VBS-protected data. This research also revealed methods to bypass VBS's UEFI locks, even without physical access, by invalidating key VBS files.[33]

These Black Hat presentations consistently demonstrate how adversaries adapt to new security boundaries, forcing continuous defensive evolution. The detailed technical analyses presented at these conferences provide computer engineers with crucial information on the practical exploitability of VBS components and the necessary countermeasures.

### **5.2. Blue Hat Learnings**

Blue Hat conferences, often driven by Microsoft's internal security research, serve as a platform for highlighting emerging threats and proactive defense strategies.

* **VBS Enclave Misuse (Blue Hat IL):** Research presented at Blue Hat IL focused on "enclave malware," detailing how VBS enclaves, designed for security, could be abused to create highly evasive malware. The "Mirage" technique, a proof-of-concept memory evasion method, was introduced, demonstrating how malware could operate within VTL1, making it inaccessible to traditional EDRs and security analysts.[1]  
* **Token Theft (Blue Hat IL 2023):** Discussions at Blue Hat IL 2023 addressed the critical problem of token theft, particularly Primary Refresh Tokens (PRTs) used in federated identity systems like Azure Active Directory (AAD) SSO. The presentations highlighted how attackers could intercept and replay these tokens, emphasizing the need for storing them in hardware-backed secure environments to avoid detection by EDR/XDR systems.[35] While not directly about VBS architecture, this reinforces the motivation for Credential Guard's isolation of sensitive authentication material.

Blue Hat events underscore the dual nature of advanced security technologies and the continuous need for vigilance. They highlight how Microsoft's internal research efforts contribute to understanding and mitigating emerging threats, often providing early warnings about sophisticated attack vectors.

### **5.3. DEF CON Learnings**

DEF CON serves as a crucible for practical exploitation and community-driven security research, often showcasing hands-on bypasses and novel attack methodologies.

* **Offensive Operations with Secure Enclaves (DEF CON 29, 2025):** Research presented at DEF CON has explored the use of secure enclaves for offensive operations. While earlier work focused on Intel SGX enclaves, newer research investigates the use of VBS enclaves for stealthy operations. These discussions highlight how enclaves, despite their security purpose, could be leveraged by red teams to slip malicious code into a secure region, creating a foothold that is harder for EDR solutions to inspect.[16]  
* **Virtualized Network Attacks (DEF CON 23, 24):** While not directly focused on VBS, DEF CON has featured extensive research on virtualization-specific network attacks, such as VLAN hopping, ARP poisoning, and Man-in-the-Middle attacks across major hypervisor platforms, including Microsoft Hyper-V. This demonstrates that even the virtualized network infrastructure can be a target, regardless of VBS protections for the OS kernel.[36]  
* **EDR Evasion (DEF CON 2025 Training):** Training sessions at DEF CON provide deep dives into Windows security components, memory management, and process manipulation to bypass modern detection strategies. These sessions often cover advanced in-memory evasion and kernel-level persistence, which are directly relevant to understanding how VBS-protected environments might still be targeted or circumvented.[37]  
* **Windows Hello Vulnerabilities (DEF CON 32):** Presentations have showcased vulnerabilities in Windows Hello, Microsoft's biometric authentication system, demonstrating how attackers can bypass biometric protections and steal Primary Refresh Tokens (PRTs) without needing actual biometric data. This directly relates to the broader challenge of credential protection that VBS aims to address.[38]

DEF CON emphasizes the practical application of security research, providing computer engineers with insights into real-world exploitation techniques and the evolving methods used by adversaries to bypass even advanced security features.

### **5.4. Microsoft Security Response Center (MSRC) and CVEs**

The Microsoft Security Response Center (MSRC) plays a critical role in formal vulnerability management, investigating reported security vulnerabilities affecting Microsoft products and services, and providing timely security updates and advisories.[39] The MSRC's disclosures, often accompanied by Common Vulnerabilities and Exposures (CVE) identifiers, are crucial for understanding specific VBS-related flaws and their remediation.

Key VBS-related CVEs and their implications include:

* **CVE-2024-49706:** This vulnerability allowed unsigned modules to be loaded into enclaves, a critical flaw that has since been patched, demonstrating the importance of strict code signing enforcement for VBS components.[18]  
* **CVE-2023-36880:** A vulnerability in Microsoft Edge that was exploited in "Bring Your Own Vulnerable Enclave" (BYOVE) attacks, allowing attackers to gain arbitrary read/write access or execute malicious payloads within signed enclave modules.[1] This highlights the risk posed by vulnerabilities in legitimate, signed software components that interact with VBS.  
* **CVE-2025-27735:** Described as an "Insufficient verification of data authenticity in Windows Virtualization-Based Security (VBS) Enclave," this vulnerability allows an authorized attacker to bypass a security feature locally.[41] This type of flaw can undermine the integrity of data processed within the enclave.  
* **CVE-2025-21340:** Identified as a "Windows Virtualization-Based Security (VBS) Security Feature Bypass Vulnerability," this local vulnerability with low privileges and no user interaction allows an attacker to bypass a security feature, impacting confidentiality.[42]  
* **Speculative Execution Side-Channel Attacks (e.g., L1TF, MDS):** MSRC has issued advisories and patches for these hardware-level vulnerabilities (e.g., CVE-2018-11091, CVE-2018-12126, CVE-2018-12127, CVE-2018-12130) that can impact the confidentiality of VBS secrets, especially when Hyper-Threading is enabled.[25]  
* **Windows Downgrade Attacks:** While specific CVEs for the broader "Windows Downgrade Attack" framework are not exclusively VBS-related, vulnerabilities such as CVE-2024-38193 (Scripting Engine Memory Corruption), CVE-2024-38213 (Windows Ancillary Function Driver for WinSock Elevation of Privilege), and CVE-2024-38160/CVE-2024-38159 (Windows Mark of the Web Security Feature Bypass) have been associated with this attack class, demonstrating how they can lead to bypassing VBS features.[33]

MSRC's role in formal vulnerability disclosure and remediation is paramount. The continuous stream of CVEs related to VBS and its underlying components underscores that even advanced security features require ongoing patching and vigilance. For computer engineers, staying abreast of MSRC advisories and implementing timely updates is a critical defense strategy against known vulnerabilities.

## **6\. Conclusions and Recommendations**

Virtualization-based Security in Windows represents a pivotal evolution in operating system security, shifting from a model of implicit kernel trust to one that proactively anticipates and mitigates kernel compromise. By leveraging hardware-assisted virtualization, VBS creates isolated environments (VTL1, IUM, VBS enclaves) to protect critical security functions and sensitive data, fundamentally enhancing the system's resilience against sophisticated attacks like credential theft and kernel exploits. Features like Credential Guard and Hypervisor-Protected Code Integrity (HVCI) are direct manifestations of this architectural philosophy, providing robust defenses against a range of modern threats.

However, the analysis of VBS's evolution and its exposure at major cybersecurity conferences reveals a continuous adversarial innovation cycle. The very isolation that makes VBS powerful also creates new "blind spots" for traditional detection mechanisms, as demonstrated by the misuse of VBS enclaves for evasive malware through techniques like BYOVE and "Mirage." Furthermore, the effectiveness of VBS is deeply intertwined with the integrity of the underlying hardware and firmware, making vulnerabilities in components like SMM, Secure Boot, or speculative execution features critical points of failure. The rapid deprecation of VBS enclaves in older Windows 11 versions also highlights the challenges of feature lifecycle management in a fast-paced OS development environment, necessitating that organizations remain current with Windows versions to leverage the latest security advancements.

For computer engineers tasked with designing, deploying, and securing Windows environments, several key recommendations emerge:

1. **Holistic Security Approach:** Recognize that VBS is not a standalone solution but a component of a broader security ecosystem. Its effectiveness is contingent on the integrity of the entire hardware and firmware stack. Prioritize systems with robust hardware security features (TPM 2.0, IOMMUs, WMST-compliant UEFI firmware, Secure Boot).  
2. **Proactive Threat Intelligence and Patch Management:** Stay continuously informed about new vulnerabilities and exploitation techniques targeting VBS, as disclosed by MSRC and presented at conferences like Black Hat and DEF CON. Implement timely patching for both the operating system and all third-party software, especially signed enclave modules, to mitigate known attack vectors.  
3. **Adaptation of Detection Strategies:** Acknowledge that traditional EDRs may have blind spots within VBS-isolated environments. Develop and implement advanced detection strategies that focus on monitoring anomalous activity related to VBS components, tracking enclave-specific API calls, and establishing baselines for legitimate enclave usage.  
4. **Careful Configuration and Deployment:** Understand the trade-offs between maximum security (e.g., VBS with UEFI lock) and operational manageability. Choose VBS configurations that align with organizational risk appetite and infrastructure capabilities, ensuring robust remote management is possible if UEFI locks are not used.  
5. **Continuous Research and Auditing:** Engage in ongoing research and auditing of VBS implementations, particularly for custom or third-party enclave modules. The "Bring Your Own Vulnerable Enclave" paradigm underscores the need for rigorous security assessments of all code running in VTL1, even if signed by trusted entities.  
6. **Prioritize Latest OS Versions:** Given Microsoft's rapid release cycles and the deprecation of features in older versions, maintaining updated Windows versions is crucial for accessing the latest VBS enhancements and ensuring continued support for critical security features.

By adopting these recommendations, computer engineers can better leverage the powerful capabilities of Virtualization-based Security in Windows, navigate its complexities, and fortify systems against the ever-evolving landscape of advanced cyber threats.

#### **Works cited**

1. Abusing VBS Enclaves to Create Evasive Malware \- Akamai, accessed on June 6, 2025, [https://www.akamai.com/blog/security-research/2025-february-abusing-vbs-enclaves-evasive-malware](https://www.akamai.com/blog/security-research/2025-february-abusing-vbs-enclaves-evasive-malware)  
2. What Is Virtual Secure Mode (VSM)? \- ITU Online IT Training, accessed on June 6, 2025, [https://www.ituonline.com/tech-definitions/what-is-virtual-secure-mode-vsm/](https://www.ituonline.com/tech-definitions/what-is-virtual-secure-mode-vsm/)  
3. Understanding Virtualization-Based Security in Windows 10/11 Home Editions, accessed on June 6, 2025, [https://learn.microsoft.com/en-us/answers/questions/2144647/understanding-virtualization-based-security-in-win](https://learn.microsoft.com/en-us/answers/questions/2144647/understanding-virtualization-based-security-in-win)  
4. Enable virtualization-based protection of code integrity \- Learn Microsoft, accessed on June 6, 2025, [https://learn.microsoft.com/en-us/windows/security/hardware-security/enable-virtualization-based-protection-of-code-integrity](https://learn.microsoft.com/en-us/windows/security/hardware-security/enable-virtualization-based-protection-of-code-integrity)  
5. Virtualization-based Security (VBS) | Microsoft Learn, accessed on June 6, 2025, [https://learn.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-vbs](https://learn.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-vbs)  
6. ANALYSIS OF THE ATTACK SURFACE OF WINDOWS ... \- Black Hat, accessed on June 6, 2025, [https://www.blackhat.com/docs/us-16/materials/us-16-Wojtczuk-Analysis-Of-The-Attack-Surface-Of-Windows-10-Virtualization-Based-Security-wp.pdf](https://www.blackhat.com/docs/us-16/materials/us-16-Wojtczuk-Analysis-Of-The-Attack-Surface-Of-Windows-10-Virtualization-Based-Security-wp.pdf)  
7. Isolated User Mode (IUM) Processes \- Win32 apps | Microsoft Learn, accessed on June 6, 2025, [https://learn.microsoft.com/en-us/windows/win32/procthread/isolated-user-mode--ium--processes](https://learn.microsoft.com/en-us/windows/win32/procthread/isolated-user-mode--ium--processes)  
8. Windows 10 Enterprise Security: Credential Guard and Device ... \- Dell, accessed on June 6, 2025, [https://www.dell.com/support/kbdoc/en-us/000178346/windows-10-enterprise-security-credential-guard-and-device-guard](https://www.dell.com/support/kbdoc/en-us/000178346/windows-10-enterprise-security-credential-guard-and-device-guard)  
9. Credential Guard overview | Microsoft Learn, accessed on June 6, 2025, [https://learn.microsoft.com/en-us/windows/security/identity-protection/credential-guard/](https://learn.microsoft.com/en-us/windows/security/identity-protection/credential-guard/)  
10. Virtualization-Based Security: Pros, Cons, and Use Cases for Windows 10, 11, and Server Environments \- Jaspreet Singh, accessed on June 6, 2025, [https://www.jaspreet.net/2024/10/12/2734/virtualization-based-security-pros-cons-and-use-cases-for-windows-10-11-and-server-environments/](https://www.jaspreet.net/2024/10/12/2734/virtualization-based-security-pros-cons-and-use-cases-for-windows-10-11-and-server-environments/)  
11. Virtualization-based Security Best Practices \- Broadcom Tech Docs, accessed on June 6, 2025, [https://techdocs.broadcom.com/us/en/vmware-cis/vsphere/vsphere/7-0/vsphere-security-7-0/securing-windows-guest-operating-systems-with-virtual-based-security/virtualization-based-security-best-practices.html](https://techdocs.broadcom.com/us/en/vmware-cis/vsphere/vsphere/7-0/vsphere-security-7-0/securing-windows-guest-operating-systems-with-virtual-based-security/virtualization-based-security-best-practices.html)  
12. \[Motherboard\]How to set VT(Virtualization Technology) in BIOS and install Virtual Machine in Windows | Official Support | ASUS USA, accessed on June 6, 2025, [https://www.asus.com/us/support/faq/1045141/](https://www.asus.com/us/support/faq/1045141/)  
13. \[Motherboard\]How to set VT(Virtualization Technology) in BIOS and install Virtual Machine in Windows | Official Support \- ASUS, accessed on June 6, 2025, [https://www.asus.com/support/faq/1045141/](https://www.asus.com/support/faq/1045141/)  
14. Windows Server Virtualization & The Windows Hypervisor \- Black Hat, accessed on June 6, 2025, [https://www.blackhat.com/presentations/bh-usa-07/Baker/Presentation/BH07\_Baker\_WSV\_Hypervisor\_Security.pdf](https://www.blackhat.com/presentations/bh-usa-07/Baker/Presentation/BH07_Baker_WSV_Hypervisor_Security.pdf)  
15. How to Disable VBS in Windows 11 to Improve Performance \- Wise Cleaner, accessed on June 6, 2025, [https://www.wisecleaner.com/think-tank/699-How-to-Disable-VBS-in-Windows-11-to-Improve-Performance.html](https://www.wisecleaner.com/think-tank/699-How-to-Disable-VBS-in-Windows-11-to-Improve-Performance.html)  
16. Secure Enclaves for Offensive Operations (Part I) | Outflank | OST, accessed on June 6, 2025, [https://www.outflank.nl/blog/2025/02/03/secure-enclaves-for-offensive-operations-part-i/](https://www.outflank.nl/blog/2025/02/03/secure-enclaves-for-offensive-operations-part-i/)  
17. Understanding Virtualization-Based Security in Windows 10/11 Home Editions, accessed on June 6, 2025, [https://learn.microsoft.com/en-sg/answers/questions/2144647/understanding-virtualization-based-security-in-win](https://learn.microsoft.com/en-sg/answers/questions/2144647/understanding-virtualization-based-security-in-win)  
18. Windows Virtualization-Based Security Misused to Create Stealthy and Evasive Malware, accessed on June 6, 2025, [https://cyberpress.org/windows-virtualization-based-security-misused/](https://cyberpress.org/windows-virtualization-based-security-misused/)  
19. Introducing support for Virtualization Based Security and Credential Guard in vSphere 6.7, accessed on June 6, 2025, [https://blogs.vmware.com/vsphere/2018/05/introducing-support-virtualization-based-security-credential-guard-vsphere-6-7.html](https://blogs.vmware.com/vsphere/2018/05/introducing-support-virtualization-based-security-credential-guard-vsphere-6-7.html)  
20. Windows 10 Virtualization-Based Security On By Default in Future Updates, accessed on June 6, 2025, [https://petri.com/windows-10-virtualization-based-security-on-by-default-in-future-updates/](https://petri.com/windows-10-virtualization-based-security-on-by-default-in-future-updates/)  
21. BlueHatIL \- Abstracts, accessed on June 6, 2025, [https://www.microsoftrnd.co.il/bluehatil/conference/abstracts](https://www.microsoftrnd.co.il/bluehatil/conference/abstracts)  
22. Deprecated: Virtualization-based security (VBS enclaves) before Windows 11 24H2; Windows UWP Map Control/API \- BornCity, accessed on June 6, 2025, [https://borncity.com/win/2025/04/21/deprecated-virtualization-based-security-vbs-enclaves-before-windows-11-24h2-windows-uwp-map-control-api/](https://borncity.com/win/2025/04/21/deprecated-virtualization-based-security-vbs-enclaves-before-windows-11-24h2-windows-uwp-map-control-api/)  
23. Virtualization-based security (VBS) enclaves \- Learn Microsoft, accessed on June 6, 2025, [https://learn.microsoft.com/en-us/windows/win32/trusted-execution/vbs-enclaves](https://learn.microsoft.com/en-us/windows/win32/trusted-execution/vbs-enclaves)  
24. Mitigate threats by using Windows 10 security features \- Learn Microsoft, accessed on June 6, 2025, [https://learn.microsoft.com/en-us/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10](https://learn.microsoft.com/en-us/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10)  
25. KB4457951: Windows guidance to protect against speculative execution side-channel vulnerabilities \- Microsoft Support, accessed on June 6, 2025, [https://support.microsoft.com/en-us/topic/kb4457951-windows-guidance-to-protect-against-speculative-execution-side-channel-vulnerabilities-ae9b7bcd-e8e9-7304-2c40-f047a0ab3385](https://support.microsoft.com/en-us/topic/kb4457951-windows-guidance-to-protect-against-speculative-execution-side-channel-vulnerabilities-ae9b7bcd-e8e9-7304-2c40-f047a0ab3385)  
26. Configure Credential Guard | Microsoft Learn, accessed on June 6, 2025, [https://learn.microsoft.com/en-us/windows/security/identity-protection/credential-guard/configure](https://learn.microsoft.com/en-us/windows/security/identity-protection/credential-guard/configure)  
27. Microsoft deprecates "revolutionary" virtualization-based security feature in older Windows 11 versions | TechSpot, accessed on June 6, 2025, [https://www.techspot.com/news/107609-microsoft-deprecating-revolutionary-virtualization-based-security-feature-older.html](https://www.techspot.com/news/107609-microsoft-deprecating-revolutionary-virtualization-based-security-feature-older.html)  
28. Microsoft Phasing Out 'Revolutionary' Virtualization-Based Security Feature for Legacy Windows 11 Versions, accessed on June 6, 2025, [https://cheapwindowsvps.com/blog/microsoft-phasing-out-revolutionary-virtualization-based-security-feature-for-legacy-windows-11-versions/](https://cheapwindowsvps.com/blog/microsoft-phasing-out-revolutionary-virtualization-based-security-feature-for-legacy-windows-11-versions/)  
29. Microsoft Phases Out 'Revolutionary' Virtualization-Based Security Feature for Legacy Windows 11 Versions \- ColoCrossing, accessed on June 6, 2025, [https://www.colocrossing.com/blog/microsoft-phases-out-revolutionary-virtualization-based-security-feature-for-legacy-windows-11-versions/](https://www.colocrossing.com/blog/microsoft-phases-out-revolutionary-virtualization-based-security-feature-for-legacy-windows-11-versions/)  
30. Microsoft Phases Out 'Revolutionary' Virtualization-Based Security Feature for Older Windows 11 Versions | Hudson Valley Host, accessed on June 6, 2025, [https://hudsonvalleyhost.com/blog/microsoft-phases-out-revolutionary-virtualization-based-security-feature-for-older-windows-11-versions/](https://hudsonvalleyhost.com/blog/microsoft-phases-out-revolutionary-virtualization-based-security-feature-for-older-windows-11-versions/)  
31. Features removed or no longer developed in Windows Server \- Learn Microsoft, accessed on June 6, 2025, [https://learn.microsoft.com/en-us/windows-server/get-started/removed-deprecated-features-windows-server](https://learn.microsoft.com/en-us/windows-server/get-started/removed-deprecated-features-windows-server)  
32. Windows 11, version 24H2 \- Wikipedia, accessed on June 6, 2025, [https://en.wikipedia.org/wiki/Windows\_11,\_version\_24H2](https://en.wikipedia.org/wiki/Windows_11,_version_24H2)  
33. Microsoft Patch Tuesday August 2024 \- Arctic Wolf, accessed on June 6, 2025, [https://arcticwolf.com/resources/blog/microsoft-patch-tuesday-august-2024/](https://arcticwolf.com/resources/blog/microsoft-patch-tuesday-august-2024/)  
34. Update on Windows Downdate | SafeBreach, accessed on June 6, 2025, [https://www.safebreach.com/blog/update-on-windows-downdate-downgrade-attacks/](https://www.safebreach.com/blog/update-on-windows-downdate-downgrade-attacks/)  
35. BlueHat IL 2023 \- David Weston \- Default Security \- YouTube, accessed on June 6, 2025, [https://www.youtube.com/watch?v=8T6ClX-y2AE](https://www.youtube.com/watch?v=8T6ClX-y2AE)  
36. VLAN hopping, ARP poisoning and Man-In-The-Middle Attacks in Virtualized Environments \- Clarkson University, accessed on June 6, 2025, [https://people.clarkson.edu/\~jmatthew/publications/DEFCON-24-Bull-Matthews-Trumbull-VLAN-Hopping-ARP-MITM-in-Virtualized-WP.pdf](https://people.clarkson.edu/~jmatthew/publications/DEFCON-24-Bull-Matthews-Trumbull-VLAN-Hopping-ARP-MITM-in-Virtualized-WP.pdf)  
37. Giorgio Bernardinetti \- Dodging the EDR Bullet: A Training on Malware Stealth Tactics, accessed on June 6, 2025, [https://training.defcon.org/products/dodging-the-edr-bullet-a-training-on-malware-stealth-tactics-las-vegas-2025](https://training.defcon.org/products/dodging-the-edr-bullet-a-training-on-malware-stealth-tactics-las-vegas-2025)  
38. Insights and highlights from DEF CON 32 | Pen Test Partners, accessed on June 6, 2025, [https://www.pentestpartners.com/security-blog/insights-and-highlights-from-def-con-32/](https://www.pentestpartners.com/security-blog/insights-and-highlights-from-def-con-32/)  
39. Microsoft Technical Security Notifications, accessed on June 6, 2025, [https://www.microsoft.com/en-us/msrc/technical-security-notifications](https://www.microsoft.com/en-us/msrc/technical-security-notifications)  
40. Microsoft Security Response Center, accessed on June 6, 2025, [https://msrc.microsoft.com/](https://msrc.microsoft.com/)  
41. CVE-2025-27735 Detail \- NVD, accessed on June 6, 2025, [https://nvd.nist.gov/vuln/detail/CVE-2025-27735](https://nvd.nist.gov/vuln/detail/CVE-2025-27735)  
42. Windows Virtualization-Based Security (VBS) Security... · CVE-2025-21340 · GitHub Advisory Database, accessed on June 6, 2025, [https://github.com/advisories/GHSA-8g2m-ppjp-6hg7](https://github.com/advisories/GHSA-8g2m-ppjp-6hg7)  
43. Security Update Guide \- Microsoft Security Response Center, accessed on June 6, 2025, [https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-27735](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-27735)  
44. CVE-2025-21340 : Windows Virtualization-Based Security (VBS) Security Feature Bypass Vulnerabilit \- CVE Details, accessed on June 6, 2025, [https://www.cvedetails.com/cve/CVE-2025-21340/](https://www.cvedetails.com/cve/CVE-2025-21340/)
